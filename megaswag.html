
<!DOCTYPE html>
<html>
<head>
    <title>Dane osobowe</title>
    <meta charset="utf-8"/>
    <script>
        function show(form){
            alert('Imię: '+form.firstName.value +
                '\nNazwisko: '+form.lastName.value +
                '\nPesel: '+form.pesel.value +
                '\nPłeć: '+form.gender.value +
                '\ndata urodzenia: '+form.birth.value);
        }
    </script>
</head>
<body>
<form onsubmit='show(this); return false;'>
    <div><label for='firstNameField'>Imię:</label>
        <input type="text" name='firstName'
               id='firstNameField'
               required='required'
               placeholder='Wpisz swoje imię'
               autofocus='autofocus' />
    </div>
    <div><label for='lastNameField'>Nazwisko:</label>
        <input type="text" name='lastName'
               id='lastNameField'
               required='required'
               placeholder='Wpisz swoje nazwisko'
        />
    </div>

    <label for="pesel" class="label">Pesel</label>
    <input id="pesel" type="number" class="input" required="required">
    <button id="button" class="button">Sprawdź</button>
    <span id="result" class="result"></span>
    <script>

        var dateOfBirth
        let sum = 0
        let checkDigit = 0

        //how to check if pesel number is correct
        //1*a + 3*b + 7*c + 9*d + 1*e + 3*f + 7*g + 9*h + 1*i + 3*j || last == result
        const weights = [1, 3, 7, 9, 1, 3, 7, 9, 1, 3]

        const results = [
            {
                status: false,
                message: 'Pesel musi składać się z 11 cyfr',
            },
            {
                status: false,
                message: 'Pesel nieprawidłowy',
            },
            {
                status: true,
                message: 'Pesel prawidłowy',
            }
        ]

        monthSingleDigit= {"1": "01", "2": "02", "3": "03", "4": "04", "5": "05", "6": "06", "7": "07",
            "8": "08", "9": "09"}
        monthTwoDigit = {"0": "10", "1": "11", "2": "12"}

        const checkPesel = (pesel) => {
            //zamiana inputu na tablice typu Int
            let peselArr = pesel.split('')
            peselArr = peselArr.map((el) => parseInt(el))
            //tu podstawia do wzorku wyżej
            peselArr.forEach((element, index, peselArr) => {
                if (index === peselArr.length - 1) return
                sum += parseInt(element) * parseInt(weights[index])
            })
            //sprawdzenie ostatniego indexu tablicy
            checkDigit = 10 - ( sum % 10 )


            //zwraca komunikat czy pesel jest poprawny
            if (peselArr.length !== 11) return results[0];
            if (checkDigit === peselArr[10]) return results[2];



            return results[1]
        }

        function getDate(pesel) {

            //zamiana inputu na tablice typu Int
            let peselArr = pesel.split('')
            peselArr = peselArr.map((el) => parseInt(el))

            //1800-1899
            if(pesel[2] == 8 || pesel[2] == 9){
                if(pesel[2] % 2 == 0) {
                    return `18${pesel[0]}${pesel[1]}-${monthSingleDigit[pesel[3]]}-${pesel[4]}${pesel[5]}`
                }else{
                    return `18${pesel[0]}${pesel[1]}-${monthTwoDigit[pesel[3]]}-${pesel[4]}${pesel[5]}`
                }
            }

            //1900-1999
            if(pesel[2] == 0 || pesel[2] == 1){
                if(pesel[2] % 2 == 0) {
                    return `19${pesel[0]}${pesel[1]}-${monthSingleDigit[pesel[3]]}-${pesel[4]}${pesel[5]}`
                }else{
                    return `19${pesel[0]}${pesel[1]}-${monthTwoDigit[pesel[3]]}-${pesel[4]}${pesel[5]}`
                }
            }

            //2000-2099
            if(pesel[2] == 2 || pesel[2] == 3){
                if(pesel[2] % 2 == 0) {
                    return `20${pesel[0]}${pesel[1]}-${monthSingleDigit[pesel[3]]}-${pesel[4]}${pesel[5]}`
                }else{
                    return `20${pesel[0]}${pesel[1]}-${monthTwoDigit[pesel[3]]}-${pesel[4]}${pesel[5]}`
                }
            }

            //2100-2199
            if(pesel[2] == 4 || pesel[2] == 5){
                if(pesel[2] % 2 == 0) {
                    return `21${pesel[0]}${pesel[1]}-${monthSingleDigit[pesel[3]]}-${pesel[4]}${pesel[5]}`
                }else{
                    return `21${pesel[0]}${pesel[1]}-${monthTwoDigit[pesel[3]]}-${pesel[4]}${pesel[5]}`
                }
            }

            //2200-2299
            if(pesel[2] == 6 || pesel[2] == 7){
                if(pesel[2] % 2 == 0) {
                    return `22${pesel[0]}${pesel[1]}-${monthSingleDigit[pesel[3]]}-${pesel[4]}${pesel[5]}`
                }else{
                    return `22${pesel[0]}${pesel[1]}-${monthTwoDigit[pesel[3]]}-${pesel[4]}${pesel[5]}`
                }
            }


        }

        //tego nie tykalem ale to do przycisku sie odnosi
        const button = document.querySelector('#button')
        const result = document.querySelector('#result')

        button.addEventListener('click', () => {

            const pesel = document.querySelector('#pesel').value
            const checkStatus = checkPesel(pesel)
            result.classList.remove('error', 'success')
            result.innerHTML = checkStatus.message
            console.log(getDate(pesel))

            if (checkStatus.status === false) {
                result.classList.add('error')
            } else {
                result.classList.add('success')
            }

        })


    </script>

    <div><label for='genderRadio'>Płeć:</label></br>
        <input type="radio" id="kobieta" name="gender" value="kobieta" id="genderRadio" checked="checked">
        <label for="kobieta">Kobieta</label><br>
        <input type="radio" id="mezczyzna" name="gender" value="mezczyzna">
        <label for="mezczyzna">Mężczyzna</label><br>
    </div>

    <div><label for='birthField'>Data urodzenia </label>
        <input type="date" id="birthField" name="birth"
               required='required'>
    </div>

    <div><label for="robotCheckbox">Nie jestem robotem</label>
        <input type="checkbox" name="robotCheckbox" id="robotCheckbox" required="required"/></div>
    <button type="submit" onsubmit="show(form)">Zatwierdź</button>
</form>








</body>
</html>